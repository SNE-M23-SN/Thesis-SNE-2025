<!DOCTYPE HTML>
<html lang="ru">
<head>
<!-- Generated by javadoc (21) on Thu Jun 05 13:28:45 TJT 2025 -->
<title>ChatMessageRepository</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2025-06-05">
<meta name="description" content="declaration: package: com.diploma.inno.repository, interface: ChatMessageRepository">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/ChatMessageRepository.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.diploma.inno.repository</a></div>
<h1 title="Interface ChatMessageRepository" class="title">Interface ChatMessageRepository</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code>org.springframework.data.repository.CrudRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code>, <code>org.springframework.data.jpa.repository.JpaRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code>, <code>org.springframework.data.repository.ListCrudRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code>, <code>org.springframework.data.repository.ListPagingAndSortingRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code>, <code>org.springframework.data.repository.PagingAndSortingRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code>, <code>org.springframework.data.repository.query.QueryByExampleExecutor&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>&gt;</code>, <code>org.springframework.data.repository.Repository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations">@Repository
</span><span class="modifiers">public interface </span><span class="element-name type-name-label">ChatMessageRepository</span><span class="extends-implements">
extends org.springframework.data.jpa.repository.JpaRepository&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span></div>
<div class="block">Repository interface for managing chat message entities and providing comprehensive data access for Jenkins CI/CD monitoring and AI analysis.

 <p>This repository serves as the central data access layer for the CI Anomaly Detector system,
 extending <code>JpaRepository</code> and providing specialized query methods for complex JSONB operations,
 dashboard analytics, and real-time monitoring of Jenkins builds and AI analysis results.</p>

 <p><strong>Core Functionality:</strong></p>
 <ul>
   <li><strong>Chat Message CRUD:</strong> Standard entity operations with conversation management</li>
   <li><strong>AI Analysis Retrieval:</strong> Complex JSONB queries for anomaly detection and risk scoring</li>
   <li><strong>Build Log Management:</strong> Tracking and pagination of Jenkins build logs</li>
   <li><strong>Dashboard Analytics:</strong> Aggregated data for real-time monitoring dashboards</li>
   <li><strong>Trend Analysis:</strong> Time-series data extraction for pattern identification</li>
   <li><strong>Materialized View Integration:</strong> Performance-optimized queries via pre-computed views</li>
 </ul>

 <p><strong>Database Schema Integration:</strong></p>
 <pre>
 Primary Table: chat_messages
 ┌─────────────────┬──────────────────┬─────────────────────────────────────────────────────┐
 │ Column          │ Type             │ Purpose                                             │
 ├─────────────────┼──────────────────┼─────────────────────────────────────────────────────┤
 │ id              │ BIGINT           │ Primary key, auto-generated                         │
 │ conversation_id │ VARCHAR          │ Jenkins job name (conversation identifier)          │
 │ build_number    │ INTEGER          │ Jenkins build number                                │
 │ message_type    │ VARCHAR          │ 'USER' (build logs) or 'ASSISTANT' (AI analysis)    │
 │ content         │ JSONB            │ Structured data (logs or AI analysis results)       │
 │ timestamp       │ TIMESTAMPTZ      │ Message creation time (UTC+5)                       │
 │ created_at      │ TIMESTAMPTZ      │ Entity creation time (UTC+5)                        │
 │ job_name        │ VARCHAR          │ Duplicate of conversation_id for query optimization │
 │ metadata        │ JSONB            │ Additional metadata (via JsonMapConverter)          │
 └─────────────────┴──────────────────┴─────────────────────────────────────────────────────┘

 Materialized Views:
 - recent_job_builds: Pre-computed recent build metrics with health status
 - security_anomaly_counts: Aggregated security anomaly statistics
 - active_build_counts: Real-time active build counts by job filter
 - job_counts: Total job counts by time boundary
 - build_anomaly_summary: Aggregated anomaly counts and severity distribution
 </pre>

 <p><strong>JSONB Content Structures:</strong></p>

 <span><b>ASSISTANT messages (AI Analysis Results)</b></span>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json"> {
   "anomalies": [
     {
       "severity": "CRITICAL|HIGH|MEDIUM|WARNING|LOW",
       "type": "security|performance|quality|configuration|...",
       "description": "Human-readable anomaly description",
       "details": "Technical details and context",
       "aiAnalysis": "AI reasoning and analysis",
       "recommendation": "Suggested remediation steps"
     }
   ],
   "buildMetadata": {
     "status": "SUCCESS|FAILURE|UNSTABLE|ABORTED",
     "duration": "Build execution time",
     "startTime": "Build start timestamp",
     "timestamp": "Build completion timestamp"
   },
   "riskScore": {
     "score": 75,
     "change": 15,
     "riskLevel": "HIGH",
     "previousScore": 60
   },
   "insights": {
     "summary": "Overall build analysis summary",
     "recommendations": ["Action items for improvement"],
     "trends": {"pattern": "analysis", "direction": "improving|deteriorating"}
   }
 }
</code></pre>
</div>

 <span><b>USER messages (Build Logs)</b></span>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "build_log_data",
  "log_chunk": "Raw Jenkins build log content",
  "chunk_index": 1,
  "total_chunks": 14,
  "timestamp": "Log collection timestamp"
}
</code></pre>
</div>



 <p><strong>Query Performance Optimization:</strong></p>
 <ul>
   <li><strong>Native SQL:</strong> Complex JSONB operations using PostgreSQL-specific features</li>
   <li><strong>GIN Indexes:</strong> Optimized JSONB field indexing for fast content queries</li>
   <li><strong>Composite Indexes:</strong> (conversation_id, build_number) for build-specific queries</li>
   <li><strong>Materialized Views:</strong> Pre-computed aggregations for dashboard performance</li>
   <li><strong>Pagination Support:</strong> LIMIT/OFFSET for large result sets</li>
   <li><strong>CTE Queries:</strong> Complex analytical queries with Common Table Expressions</li>
 </ul>

 <p><strong>Service Layer Integration:</strong></p>
 <ul>
   <li><strong>DashboardService:</strong> Primary consumer for dashboard analytics and metrics</li>
   <li><strong>Scheduled Tasks:</strong> 15-minute Jenkins synchronization via @Scheduled methods</li>
   <li><strong>REST Controllers:</strong> Data provision for API endpoints and dashboard widgets</li>
   <li><strong>AI Analysis Pipeline:</strong> Storage and retrieval of AI analysis results</li>
 </ul>

 <p><strong>Data Lifecycle Management:</strong></p>
 <ul>
   <li><strong>Message Creation:</strong> USER messages for build logs, ASSISTANT for AI analysis</li>
   <li><strong>Conversation Management:</strong> Grouping by Jenkins job names (conversation_id)</li>
   <li><strong>Build Tracking:</strong> Association with specific Jenkins build numbers</li>
   <li><strong>Cleanup Operations:</strong> Sliding window deletion and orphaned job removal</li>
   <li><strong>Synchronization:</strong> Periodic sync with Jenkins job state</li>
 </ul>

 <p><strong>Error Handling &amp; Resilience:</strong></p>
 <ul>
   <li><strong>Null Safety:</strong> Graceful handling of missing or malformed JSONB data</li>
   <li><strong>Transaction Support:</strong> @Transactional annotations for data consistency</li>
   <li><strong>Fallback Responses:</strong> Default values when queries return no results</li>
   <li><strong>Safety Checks:</strong> Bulk deletion limits to prevent accidental data loss</li>
 </ul></div>
<dl class="notes">
<dt>Since:</dt>
<dd>1.0</dd>
<dt>Version:</dt>
<dd>1.0</dd>
<dt>Author:</dt>
<dd>Khasan Abdurakhmanov</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity"><code>ChatMessageEntity</code></a></li>
<li><a href="../service/DashboardService.html" title="class in com.diploma.inno.service"><code>DashboardService</code></a></li>
<li><a href="../controller/DashboardController.html" title="class in com.diploma.inno.controller"><code>DashboardController</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#countByConversationIdAndBuildNumberAndContentContaining(java.lang.String,int)" class="member-name-link">countByConversationIdAndBuildNumberAndContentContaining</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 int&nbsp;buildNumber)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Counts build log messages for a specific conversation and build number.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deleteByConversationId(java.lang.String)" class="member-name-link">deleteByConversationId</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Deletes all messages associated with a specific conversation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deleteByJobNameIn(java.util.Collection)" class="member-name-link">deleteByJobNameIn</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;jobNames)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Deletes all chat messages associated with the given collection of job names in a single transaction.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#deleteOldMessages(java.lang.String,int)" class="member-name-link">deleteOldMessages</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 int&nbsp;limit)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Deletes old messages from a conversation, keeping only the most recent N messages.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../dto/ActiveBuildCountProjection.html" title="interface in com.diploma.inno.dto">ActiveBuildCountProjection</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findActiveBuildCountByJobFilter(java.lang.String)" class="member-name-link">findActiveBuildCountByJobFilter</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves active build count statistics for a specific job filter from the database.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findAllConversationIds()" class="member-name-link">findAllConversationIds</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves all unique conversation identifiers from the chat messages table.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findAllUserLogsByJobAndBuildWithPagination(java.lang.String,java.lang.Integer,java.lang.Integer,java.lang.Integer)" class="member-name-link">findAllUserLogsByJobAndBuildWithPagination</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;limit,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;offset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves paginated build logs (USER messages) for a specific job and build with instruction filtering.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findBuildSummary(java.lang.String,java.lang.Integer)" class="member-name-link">findBuildSummary</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves a comprehensive build summary with health status analysis from AI analysis results.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findDistinctJobNames()" class="member-name-link">findDistinctJobNames</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves all distinct job names from the chat messages table.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../dto/JobCountProjection.html" title="interface in com.diploma.inno.dto">JobCountProjection</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findJobCountByTimeBoundary(java.lang.String)" class="member-name-link">findJobCountByTimeBoundary</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;timeBoundary)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves job count statistics for a specific time boundary from the database.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findJobsByStatus(java.lang.String)" class="member-name-link">findJobsByStatus</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;statusFilter)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves job status information with comprehensive filtering capabilities.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findLatestBuildAnomalyCounts(java.lang.String,java.lang.Integer)" class="member-name-link">findLatestBuildAnomalyCounts</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildCount)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves the latest build anomaly counts for either a specific job or all jobs, with intelligent result limiting.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findLatestBuildSeverityDistributions(java.lang.String,java.lang.Integer)" class="member-name-link">findLatestBuildSeverityDistributions</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildCount)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves the latest build severity distributions from the build anomaly summary table,
 with intelligent build count distribution across jobs.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findLatestInsights(java.lang.String,java.lang.Integer)" class="member-name-link">findLatestInsights</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves AI-generated insights for a specific build from analysis results.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findLatestInsightsByConversation(java.lang.String)" class="member-name-link">findLatestInsightsByConversation</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves the most recent AI-generated insights for a conversation (job) across all builds.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findPaginatedAnomalies(java.lang.String,java.lang.Integer,java.lang.Integer,java.lang.Long)" class="member-name-link">findPaginatedAnomalies</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;pageSize,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;offset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves paginated anomalies from AI analysis results with total count for pagination metadata.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../dto/RecentJobBuildProjection.html" title="interface in com.diploma.inno.dto">RecentJobBuildProjection</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findRecentJobBuildsByJobName(java.lang.String)" class="member-name-link">findRecentJobBuildsByJobName</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobName)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves recent builds for a specific job, ordered chronologically (newest first).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findRiskScore(java.lang.String,java.lang.Integer)" class="member-name-link">findRiskScore</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Extracts and formats risk score information from AI analysis results.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="../dto/SecurityAnomalyCountProjection.html" title="interface in com.diploma.inno.dto">SecurityAnomalyCountProjection</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findSecurityAnomalyCountByJobFilterAndTimeRange(java.lang.String,java.lang.String)" class="member-name-link">findSecurityAnomalyCountByJobFilterAndTimeRange</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;timeRange)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves security anomaly count statistics for a specific job filter and time range combination.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#findTopByConversationIdOrderByTimestampAsc(java.lang.String,int)" class="member-name-link">findTopByConversationIdOrderByTimestampAsc</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 int&nbsp;lastN)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves the most recent N chat messages for a specific conversation, ordered by timestamp.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getAllMessagesForTrend(java.time.Instant,java.time.Instant)" class="member-name-link">getAllMessagesForTrend</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;startTime,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;endTime)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves all ASSISTANT messages with content for trend analysis across all jobs.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getMessagesForTrendByJob(java.lang.String,java.time.Instant,java.time.Instant)" class="member-name-link">getMessagesForTrendByJob</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;startTime,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;endTime)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Retrieves ASSISTANT messages with content for trend analysis for a specific job.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getTrackingLogInfo(java.lang.String,java.lang.Integer)" class="member-name-link">getTrackingLogInfo</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Counts USER messages (build logs) for tracking log collection progress.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.repository.CrudRepository">Methods inherited from interface&nbsp;org.springframework.data.repository.CrudRepository</h3>
<code>count, delete, deleteAll, deleteAll, deleteAllById, deleteById, existsById, findById, save</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.jpa.repository.JpaRepository">Methods inherited from interface&nbsp;org.springframework.data.jpa.repository.JpaRepository</h3>
<code>deleteAllByIdInBatch, deleteAllInBatch, deleteAllInBatch, deleteInBatch, findAll, findAll, flush, getById, getOne, getReferenceById, saveAllAndFlush, saveAndFlush</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.repository.ListCrudRepository">Methods inherited from interface&nbsp;org.springframework.data.repository.ListCrudRepository</h3>
<code>findAll, findAllById, saveAll</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.repository.ListPagingAndSortingRepository">Methods inherited from interface&nbsp;org.springframework.data.repository.ListPagingAndSortingRepository</h3>
<code>findAll</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.repository.PagingAndSortingRepository">Methods inherited from interface&nbsp;org.springframework.data.repository.PagingAndSortingRepository</h3>
<code>findAll</code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.springframework.data.repository.query.QueryByExampleExecutor">Methods inherited from interface&nbsp;org.springframework.data.repository.query.QueryByExampleExecutor</h3>
<code>count, exists, findAll, findBy, findOne</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="findTopByConversationIdOrderByTimestampAsc(java.lang.String,int)">
<h3>findTopByConversationIdOrderByTimestampAsc</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT * FROM chat_messages WHERE conversation_id = :conversationId ORDER BY timestamp ASC FETCH FIRST :lastN ROWS ONLY",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../entity/ChatMessageEntity.html" title="class in com.diploma.inno.entity">ChatMessageEntity</a>&gt;</span>&nbsp;<span class="element-name">findTopByConversationIdOrderByTimestampAsc</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("lastN")
 int&nbsp;lastN)</span></div>
<div class="block">Retrieves the most recent N chat messages for a specific conversation, ordered by timestamp.

 <p>This method is useful for maintaining conversation context and implementing
 sliding window approaches for chat history management.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - The conversation identifier (typically Jenkins job name)</dd>
<dd><code>lastN</code> - Maximum number of recent messages to retrieve</dd>
<dt>Returns:</dt>
<dd>List of chat message entities ordered by timestamp (ascending)</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#deleteOldMessages(java.lang.String,int)"><code>deleteOldMessages(String, int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteOldMessages(java.lang.String,int)">
<h3>deleteOldMessages</h3>
<div class="member-signature"><span class="annotations">@Modifying
@Transactional
@Query(value="DELETE FROM chat_messages e WHERE e.conversation_id = :conversationId AND e.id NOT IN (SELECT e2.id FROM chat_messages e2 WHERE e2.conversation_id = :conversationId ORDER BY e2.timestamp DESC LIMIT :limit)",
       nativeQuery=true)
</span><span class="return-type">void</span>&nbsp;<span class="element-name">deleteOldMessages</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("limit")
 int&nbsp;limit)</span></div>
<div class="block">Deletes old messages from a conversation, keeping only the most recent N messages.

 <p>This method implements a sliding window cleanup strategy to prevent
 unlimited growth of conversation history while maintaining recent context.</p>

 <p><strong>Deletion Strategy:</strong></p>
 <ol>
   <li>Identifies the most recent <code>limit</code> messages by timestamp</li>
   <li>Deletes all other messages for the conversation</li>
   <li>Preserves conversation continuity and context</li>
 </ol></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - The conversation identifier to clean up</dd>
<dd><code>limit</code> - Number of recent messages to preserve</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findTopByConversationIdOrderByTimestampAsc(java.lang.String,int)"><code>findTopByConversationIdOrderByTimestampAsc(String, int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteByConversationId(java.lang.String)">
<h3>deleteByConversationId</h3>
<div class="member-signature"><span class="annotations">@Modifying
@Transactional
</span><span class="return-type">void</span>&nbsp;<span class="element-name">deleteByConversationId</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId)</span></div>
<div class="block">Deletes all messages associated with a specific conversation.

 <p>This method provides complete conversation cleanup, typically used
 when a Jenkins job is deleted or when resetting conversation state.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - The conversation identifier to delete</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findAllConversationIds()">
<h3>findAllConversationIds</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT DISTINCT conversation_id FROM chat_messages",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">findAllConversationIds</span>()</div>
<div class="block">Retrieves all unique conversation identifiers from the chat messages table.

 <p>This method is useful for discovering all active Jenkins jobs that
 have been monitored and have associated chat message data.</p></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>List of unique conversation IDs (Jenkins job names)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="countByConversationIdAndBuildNumberAndContentContaining(java.lang.String,int)">
<h3>countByConversationIdAndBuildNumberAndContentContaining</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT COUNT(*) FROM chat_messages c WHERE c.conversation_id = :conversationId AND c.build_number = :buildNumber AND c.content -&gt;&gt; \'type\' = \'build_log_data\'",
       nativeQuery=true)
</span><span class="return-type">int</span>&nbsp;<span class="element-name">countByConversationIdAndBuildNumberAndContentContaining</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 int&nbsp;buildNumber)</span></div>
<div class="block">Counts build log messages for a specific conversation and build number.

 <p>This method counts USER messages that contain build log data, which is useful
 for tracking the progress of log collection and ensuring all expected logs
 have been received for a particular build.</p>

 <p><strong>JSONB Query Details:</strong></p>
 <ul>
   <li>Uses <code>content -&gt;&gt; 'type'</code> to extract the type field as text</li>
   <li>Filters for messages with type 'build_log_data'</li>
   <li>Combines with conversation_id and build_number for precise targeting</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - The conversation identifier (Jenkins job name)</dd>
<dd><code>buildNumber</code> - The specific build number to count logs for</dd>
<dt>Returns:</dt>
<dd>Count of build log messages for the specified build</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#getTrackingLogInfo(java.lang.String,java.lang.Integer)"><code>getTrackingLogInfo(String, Integer)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findBuildSummary(java.lang.String,java.lang.Integer)">
<h3>findBuildSummary</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT jsonb_build_object(\n    \'job_name\', cm.job_name,\n    \'build_id\', cm.build_number,\n    \'health_status\', \n        CASE \n            WHEN cm.content-&gt;\'anomalies\' @&gt; \'[{\"severity\": \"CRITICAL\"}]\' \n                OR cm.content-&gt;\'anomalies\' @&gt; \'[{\"severity\": \"HIGH\"}]\' \n                THEN \'CRITICAL\'\n            WHEN (SELECT COUNT(*) FROM jsonb_array_elements(cm.content-&gt;\'anomalies\') a \n                  WHERE a-&gt;&gt;\'severity\' = \'MEDIUM\') &gt; 0\n                 OR (SELECT COUNT(*) FROM jsonb_array_elements(cm.content-&gt;\'anomalies\') a \n                    WHERE a-&gt;&gt;\'severity\' IN (\'CRITICAL\', \'HIGH\', \'MEDIUM\')) &gt; 1 \n                THEN \'WARNING\'\n            WHEN (SELECT COUNT(*) FROM jsonb_array_elements(cm.content-&gt;\'anomalies\') a \n                  WHERE a-&gt;&gt;\'severity\' IN (\'LOW\', \'WARNING\')) &lt;= 5\n                 AND NOT (cm.content-&gt;\'anomalies\' @&gt; \'[{\"severity\": \"CRITICAL\"}]\' \n                         OR cm.content-&gt;\'anomalies\' @&gt; \'[{\"severity\": \"HIGH\"}]\' \n                         OR cm.content-&gt;\'anomalies\' @&gt; \'[{\"severity\": \"MEDIUM\"}]\')\n                THEN \'Healthy\'\n            ELSE \'Unhealthy\' \n        END,\n    \'build_summary\', cm.content-&gt;&gt;\'summary\',\n    \'build_started_time\', \n        CASE \n            WHEN (cm.content-&gt;\'buildMetadata\'-&gt;&gt;\'startTime\')::timestamptz::date = CURRENT_DATE \n            THEN \'Today, \' || TO_CHAR((cm.content-&gt;\'buildMetadata\'-&gt;&gt;\'startTime\')::timestamptz, \'FMHH12:MI AM\')\n            ELSE TO_CHAR((cm.content-&gt;\'buildMetadata\'-&gt;&gt;\'startTime\')::timestamptz, \'FMDay, FMHH12:MI AM\')\n        END,\n    \'build_duration\', \n        FLOOR((cm.content-&gt;\'buildMetadata\'-&gt;&gt;\'durationSeconds\')::numeric / 60) || \'m \' || \n        ((cm.content-&gt;\'buildMetadata\'-&gt;&gt;\'durationSeconds\')::numeric % 60) || \'s\',\n    \'regression_detected\', \n        (cm.content-&gt;&gt;\'regressionFromPreviousBuilds\')::boolean\n) AS build_summary\nFROM chat_messages cm\nWHERE cm.message_type = \'ASSISTANT\'\n  AND cm.conversation_id = :conversationId\n  AND cm.build_number = :buildNumber",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">findBuildSummary</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</span></div>
<div class="block">Retrieves a comprehensive build summary with health status analysis from AI analysis results.

 <p>This method performs complex JSONB analysis to generate a complete build summary including
 health status determination based on anomaly severity, formatted timestamps, duration calculations,
 and regression detection. It's used by the dashboard to display detailed build information.</p>

 <p><strong>Health Status Logic:</strong></p>
 <ul>
   <li><strong>CRITICAL:</strong> Contains CRITICAL or HIGH severity anomalies</li>
   <li><strong>WARNING:</strong> Contains MEDIUM severity anomalies or multiple anomalies</li>
   <li><strong>Healthy:</strong> Only LOW/WARNING anomalies (≤5) and no higher severity</li>
   <li><strong>Unhealthy:</strong> Default case for other scenarios</li>
 </ul>

 <p><strong>JSONB Operations Used:</strong></p>
 <ul>
   <li><strong>jsonb_build_object:</strong> Constructs structured response object</li>
   <li><strong>@&gt; operator:</strong> JSONB containment for severity checking</li>
   <li><strong>jsonb_array_elements:</strong> Unnests anomalies array for counting</li>
   <li><strong>-&gt;&gt; operator:</strong> Extracts text values from JSONB</li>
   <li><strong>-&gt; operator:</strong> Extracts JSONB objects for nested access</li>
 </ul>

 <p><strong>Response Structure:</strong></p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "job_name": "my-web-app",
  "build_id": 123,
  "health_status": "CRITICAL|WARNING|Healthy|Unhealthy",
  "build_summary": "AI-generated build summary",
  "build_started_time": "Today, 2:30 PM or Monday, 2:30 PM",
  "build_duration": "2m 30s",
  "regression_detected": "true|false"
}
</code></pre>
</div>


 <p><strong>Time Formatting Logic:</strong></p>
 <ul>
   <li><strong>Today's builds:</strong> "Today, HH:MM AM/PM" format</li>
   <li><strong>Other days:</strong> "Day, HH:MM AM/PM" format</li>
   <li><strong>Duration:</strong> "Xm Ys" format (minutes and seconds)</li>
 </ul>

 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Service:</strong> Called by DashboardService for build detail views</li>
   <li><strong>REST API:</strong> Provides data for /api/dashboard/builds/{jobName}/{buildId}/summary</li>
   <li><strong>UI Components:</strong> Powers build summary cards and detail panels</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dd><code>buildNumber</code> - the specific build number to analyze</dd>
<dt>Returns:</dt>
<dd>JSON string containing comprehensive build summary with health status</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findRiskScore(java.lang.String,java.lang.Integer)"><code>findRiskScore(String, Integer)</code></a></li>
<li><a href="#findLatestInsights(java.lang.String,java.lang.Integer)"><code>findLatestInsights(String, Integer)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findPaginatedAnomalies(java.lang.String,java.lang.Integer,java.lang.Integer,java.lang.Long)">
<h3>findPaginatedAnomalies</h3>
<div class="member-signature"><span class="annotations">@Query(value="WITH unnested_anomalies AS (     SELECT anomaly, position     FROM chat_messages cm     CROSS JOIN LATERAL jsonb_array_elements(         COALESCE(cm.content-&gt;\'anomalies\', \'[]\'::jsonb)     ) WITH ORDINALITY AS t(anomaly, position)     WHERE cm.message_type = \'ASSISTANT\'       AND cm.conversation_id = :conversationId       AND cm.build_number = :buildNumber     ORDER BY position     LIMIT :pageSize OFFSET :offset ), total_count AS (     SELECT COUNT(*) AS total     FROM chat_messages cm     CROSS JOIN LATERAL jsonb_array_elements(         COALESCE(cm.content-&gt;\'anomalies\', \'[]\'::jsonb)     ) AS t(anomaly)     WHERE cm.message_type = \'ASSISTANT\'       AND cm.conversation_id = :conversationId       AND cm.build_number = :buildNumber ) SELECT     COALESCE(jsonb_agg(anomaly ORDER BY position), \'[]\'::jsonb) AS anomalies,     (SELECT total FROM total_count) AS total_count FROM unnested_anomalies",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</span>&nbsp;<span class="element-name">findPaginatedAnomalies</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber,
 @Param("pageSize")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;pageSize,
 @Param("offset")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;offset)</span></div>
<div class="block">Retrieves paginated anomalies from AI analysis results with total count for pagination metadata.

 <p>This method implements sophisticated JSONB array pagination using Common Table Expressions (CTEs)
 to efficiently extract, count, and paginate anomalies from the JSONB content field. It's designed
 for high-performance anomaly browsing in the dashboard interface.</p>

 <p><strong>CTE Structure:</strong></p>
 <ol>
   <li><strong>unnested_anomalies:</strong> Unnests JSONB anomalies array with position tracking</li>
   <li><strong>total_count:</strong> Calculates total anomaly count for pagination metadata</li>
   <li><strong>Final SELECT:</strong> Aggregates paginated results with total count</li>
 </ol>

 <p><strong>Advanced JSONB Operations:</strong></p>
 <ul>
   <li><strong>CROSS JOIN LATERAL:</strong> Unnests JSONB arrays while maintaining row context</li>
   <li><strong>WITH ORDINALITY:</strong> Adds position numbers to unnested elements</li>
   <li><strong>COALESCE:</strong> Handles missing anomalies arrays gracefully</li>
   <li><strong>jsonb_agg:</strong> Re-aggregates paginated results into JSONB array</li>
 </ul>

 <p><strong>Pagination Logic:</strong></p>
 <ul>
   <li><strong>LIMIT :pageSize:</strong> Controls number of anomalies per page</li>
   <li><strong>OFFSET :offset:</strong> Skips to correct page position</li>
   <li><strong>ORDER BY position:</strong> Maintains original anomaly order</li>
   <li><strong>Total Count:</strong> Separate CTE for accurate pagination metadata</li>
 </ul>

 <p><strong>Response Structure:</strong></p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "anomalies": [
    {
      "severity": "CRITICAL",
      "type": "security",
      "description": "Potential API key exposure",
      "details": "...",
      "aiAnalysis": "...",
      "recommendation": "..."
    }

  ],
  "total_count": 25
}
</code></pre>
</div>


 <p><strong>Performance Characteristics:</strong></p>
 <ul>
   <li><strong>Efficient Pagination:</strong> Only processes requested page of anomalies</li>
   <li><strong>Accurate Counting:</strong> Separate CTE ensures correct total count</li>
   <li><strong>JSONB Optimization:</strong> Leverages PostgreSQL's optimized JSONB operations</li>
   <li><strong>Memory Efficient:</strong> Streams results without loading entire anomaly set</li>
 </ul>

 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Controller:</strong> Powers /api/dashboard/builds/{jobName}/{buildId}/detected-anomalies</li>
   <li><strong>Anomaly Browser:</strong> Enables paginated browsing of build anomalies</li>
   <li><strong>Performance Optimization:</strong> Handles large anomaly sets efficiently</li>
   <li><strong>UI Pagination:</strong> Provides data for pagination controls</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dd><code>buildNumber</code> - the specific build number to analyze</dd>
<dd><code>pageSize</code> - the number of anomalies to return per page</dd>
<dd><code>offset</code> - the number of anomalies to skip (pageNumber * pageSize)</dd>
<dt>Returns:</dt>
<dd>Map containing 'anomalies' JSONB array and 'total_count' for pagination</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findBuildSummary(java.lang.String,java.lang.Integer)"><code>findBuildSummary(String, Integer)</code></a></li>
<li><a href="../controller/DashboardController.html#getDetectedAnomalies(java.lang.String,int,int,int)"><code>DashboardController.getDetectedAnomalies(java.lang.String, int, int, int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findRiskScore(java.lang.String,java.lang.Integer)">
<h3>findRiskScore</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT jsonb_build_object( \'score\', (cm.content-&gt;\'riskScore\'-&gt;&gt;\'score\')::integer, \'change\', (cm.content-&gt;\'riskScore\'-&gt;&gt;\'change\')::integer, \'riskLevel\', cm.content-&gt;\'riskScore\'-&gt;&gt;\'riskLevel\', \'previousScore\', (cm.content-&gt;\'riskScore\'-&gt;&gt;\'previousScore\')::integer ) AS risk_score FROM chat_messages cm WHERE cm.message_type = \'ASSISTANT\'   AND cm.conversation_id = :conversationId   AND cm.build_number = :buildNumber",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">findRiskScore</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</span></div>
<div class="block">Extracts and formats risk score information from AI analysis results.

 <p>This method retrieves the AI-calculated risk score data from the JSONB content field,
 including current score, change from previous build, risk level classification, and
 previous score for trend analysis. The data is formatted as a structured JSON object
 for dashboard consumption.</p>

 <p><strong>JSONB Path Extraction:</strong></p>
 <ul>
   <li><strong>content-&gt;'riskScore'-&gt;&gt;'score':</strong> Current risk score (0-100)</li>
   <li><strong>content-&gt;'riskScore'-&gt;&gt;'change':</strong> Change from previous build (+/-)</li>
   <li><strong>content-&gt;'riskScore'-&gt;&gt;'riskLevel':</strong> Categorical risk level</li>
   <li><strong>content-&gt;'riskScore'-&gt;&gt;'previousScore':</strong> Previous build's score</li>
 </ul>

 <p><strong>Risk Level Classifications:</strong></p>
 <ul>
   <li><strong>LOW:</strong> Score 0-30, minimal risk detected</li>
   <li><strong>MEDIUM:</strong> Score 31-60, moderate risk level</li>
   <li><strong>HIGH:</strong> Score 61-80, significant risk concerns</li>
   <li><strong>CRITICAL:</strong> Score 81-100, immediate attention required</li>
 </ul>

 <p><strong>Response Structure:</strong></p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "score": 75,
  "change": 15,
  "riskLevel": "HIGH",
  "previousScore": 60
}
</code></pre>
</div>


 <p><strong>Type Casting:</strong></p>
 <ul>
   <li><strong>::integer:</strong> Converts JSONB text values to integers for score/change</li>
   <li><strong>Text Values:</strong> riskLevel returned as text for categorical display</li>
   <li><strong>jsonb_build_object:</strong> Constructs structured response object</li>
 </ul>

 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Service:</strong> Called by DashboardService.getRiskScore()</li>
   <li><strong>Risk Widgets:</strong> Powers risk score dashboard widgets</li>
   <li><strong>Trend Analysis:</strong> Enables risk score trend visualization</li>
   <li><strong>Alert Systems:</strong> Provides data for risk-based alerting</li>
 </ul>

 <p><strong>AI Integration:</strong></p>
 <ul>
   <li><strong>AI Calculation:</strong> Risk scores calculated by external AI service</li>
   <li><strong>Historical Context:</strong> Includes previous score for trend analysis</li>
   <li><strong>Change Detection:</strong> Tracks risk score changes between builds</li>
   <li><strong>Categorical Mapping:</strong> Maps numeric scores to risk levels</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dd><code>buildNumber</code> - the specific build number to analyze</dd>
<dt>Returns:</dt>
<dd>JSON string containing structured risk score information</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findBuildSummary(java.lang.String,java.lang.Integer)"><code>findBuildSummary(String, Integer)</code></a></li>
<li><a href="#findLatestInsights(java.lang.String,java.lang.Integer)"><code>findLatestInsights(String, Integer)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findLatestBuildAnomalyCounts(java.lang.String,java.lang.Integer)">
<h3>findLatestBuildAnomalyCounts</h3>
<div class="member-signature"><span class="annotations">@Query(value="WITH distinct_jobs AS (     SELECT COUNT(DISTINCT conversation_id) AS total_jobs     FROM build_anomaly_summary     WHERE (:jobFilter = \'all\' OR conversation_id = :jobFilter) ), ranked_builds AS (     SELECT         conversation_id AS job,         build_number AS build,         timestamp,         total_anomalies AS anomaly_count,         ROW_NUMBER() OVER (PARTITION BY conversation_id ORDER BY timestamp DESC, build_number DESC) AS rn,         (SELECT total_jobs FROM distinct_jobs) AS total_jobs     FROM build_anomaly_summary     WHERE (:jobFilter = \'all\' OR conversation_id = :jobFilter) ), limited_builds AS (     SELECT         job,         build,         timestamp,         anomaly_count     FROM ranked_builds     WHERE (:jobFilter = \'all\' AND rn &lt;= GREATEST(1, LEAST(:buildCount / NULLIF(total_jobs, 0), :buildCount)))        OR (:jobFilter != \'all\' AND rn &lt;= :buildCount) ) SELECT * FROM limited_builds ORDER BY timestamp DESC, build DESC",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</span>&nbsp;<span class="element-name">findLatestBuildAnomalyCounts</span><wbr><span class="parameters">(@Param("jobFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 @Param("buildCount")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildCount)</span></div>
<div class="block">Retrieves the latest build anomaly counts for either a specific job or all jobs, with intelligent result limiting.

 <p>This complex query performs a multi-step analysis:</p>
 <ol>
   <li><b>distinct_jobs</b>: Counts total distinct jobs matching the filter</li>
   <li><b>ranked_builds</b>: Ranks builds per job by timestamp and build number (newest first)</li>
   <li><b>limited_builds</b>: Applies dynamic limiting based on the requested build count</li>
 </ol>


 <p><b>Filtering Behavior:</b></p>
 <ul>
   <li>When <code>jobFilter = 'all'</code>: Returns builds from all jobs, distributing the <code>buildCount</code>
       evenly across available jobs (minimum 1 build per job)</li>
   <li>For specific job filters: Returns the N most recent builds for just that job</li>
 </ul>


 <p>The query returns a list of maps containing these fields:</p>
 <ul>
   <li><b>job</b>: The job/conversation identifier</li>
   <li><b>build</b>: The build number</li>
   <li><b>timestamp</b>: When the build occurred</li>
   <li><b>anomaly_count</b>: Number of anomalies detected in this build</li>
 </ul>
 Results are always ordered by timestamp (newest first), then by build number (descending).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobFilter</code> - Either 'all' to include all jobs, or a specific job ID to filter. Must not be <code>null</code>.</dd>
<dd><code>buildCount</code> - Maximum number of builds to return. When filtering all jobs, this is distributed
                  across available jobs. Must be a positive integer.</dd>
<dt>Returns:</dt>
<dd>List of build anomaly records as maps. Returns empty list if no matching builds found.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if either parameter is <code>null</code>, or if <code>buildCount</code> is not positive</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dd><code>jakarta.persistence.QueryTimeoutException</code> - if the complex query times out</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Query</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findLatestBuildSeverityDistributions(java.lang.String,java.lang.Integer)">
<h3>findLatestBuildSeverityDistributions</h3>
<div class="member-signature"><span class="annotations">@Query(value="WITH distinct_jobs AS (     SELECT COUNT(DISTINCT conversation_id) AS total_jobs     FROM build_anomaly_summary     WHERE (:jobFilter = \'all\' OR conversation_id = :jobFilter) ), ranked_builds AS (     SELECT         conversation_id AS job,         build_number AS build,         timestamp,         severity_counts AS severity_distribution,         ROW_NUMBER() OVER (PARTITION BY conversation_id ORDER BY timestamp DESC, build_number DESC) AS rn,         (SELECT total_jobs FROM distinct_jobs) AS total_jobs     FROM build_anomaly_summary     WHERE (:jobFilter = \'all\' OR conversation_id = :jobFilter) ), limited_builds AS (     SELECT         job,         build,         timestamp,         severity_distribution     FROM ranked_builds     WHERE (:jobFilter = \'all\' AND rn &lt;= GREATEST(1, LEAST(:buildCount / NULLIF(total_jobs, 0), :buildCount)))        OR (:jobFilter != \'all\' AND rn &lt;= :buildCount) ) SELECT * FROM limited_builds ORDER BY timestamp DESC, build DESC",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</span>&nbsp;<span class="element-name">findLatestBuildSeverityDistributions</span><wbr><span class="parameters">(@Param("jobFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 @Param("buildCount")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildCount)</span></div>
<div class="block">Retrieves the latest build severity distributions from the build anomaly summary table,
 with intelligent build count distribution across jobs.

 <p>This method executes a complex native SQL query that performs the following operations:
 <ol>
   <li><strong>Job Counting:</strong> Counts distinct jobs (conversation_ids) based on the filter</li>
   <li><strong>Build Ranking:</strong> Ranks builds within each job by timestamp and build number (most recent first)</li>
   <li><strong>Smart Limiting:</strong> Distributes the requested build count across jobs intelligently</li>
 </ol>

 <h4 id="query-logic-breakdown--heading">Query Logic Breakdown:</h4>

 <h4 id="1-distinct_jobs-cte--heading">1. distinct_jobs CTE:</h4>
 <p>Counts the total number of distinct jobs (conversation_ids) that match the job filter.
 This count is used later to calculate how many builds to retrieve per job.</p>

 <h4 id="2-ranked_builds-cte--heading">2. ranked_builds CTE:</h4>
 <p>Selects and ranks all builds within each job, ordered by most recent timestamp and highest build number.
 Each build gets a row number (rn) within its job partition, starting from 1 for the most recent build.</p>

 <h4 id="3-limited_builds-cte--heading">3. limited_builds CTE:</h4>
 <p>Applies intelligent limiting logic based on the job filter:</p>
 <ul>
   <li><strong>When jobFilter = 'all':</strong> Distributes buildCount across all jobs evenly.
       Each job gets at most <code>buildCount / total_jobs</code> builds, but at least 1 build per job.
       The GREATEST(1, LEAST()) ensures each job gets at least 1 build while respecting the total limit.</li>
   <li><strong>When jobFilter is specific:</strong> Returns up to buildCount builds from the single specified job.</li>
 </ul>

 <h4 id="4-final-select--heading">4. Final SELECT:</h4>
 <p>Orders results by timestamp (descending) and build number (descending) to show most recent builds first.</p>

 <h4 id="use-cases--heading">Use Cases:</h4>
 <ul>
   <li><strong>Dashboard Overview:</strong> Get latest builds from all jobs for a system health overview</li>
   <li><strong>Job-Specific Analysis:</strong> Focus on recent builds from a particular job/conversation</li>
   <li><strong>Resource Management:</strong> Limit query results to prevent overwhelming the UI or API</li>
 </ul>

 <h4 id="example-scenarios--heading">Example Scenarios:</h4>
 <ul>
   <li>jobFilter='all', buildCount=20, total_jobs=5 → Each job returns up to 4 builds (20/5)</li>
   <li>jobFilter='all', buildCount=10, total_jobs=15 → Each job returns exactly 1 build (minimum)</li>
   <li>jobFilter='job-123', buildCount=10 → Returns up to 10 most recent builds from 'job-123'</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobFilter</code> - The job/conversation filter criteria. Use 'all' to include all jobs,
                  or specify a particular conversation_id to filter to a specific job.
                  Must not be null.</dd>
<dd><code>buildCount</code> - The maximum total number of builds to return across all selected jobs.
                   When jobFilter='all', this count is intelligently distributed across jobs.
                   When jobFilter specifies a job, this is the max builds from that job.
                   Must be a positive integer.</dd>
<dt>Returns:</dt>
<dd>A list of maps containing build severity distribution data. Each map contains:
         <ul>
           <li><strong>job:</strong> The conversation_id/job identifier (String)</li>
           <li><strong>build:</strong> The build number (Integer)</li>
           <li><strong>timestamp:</strong> When the build occurred (Timestamp)</li>
           <li><strong>severity_distribution:</strong> JSON/structured data containing severity counts</li>
         </ul>
         Results are ordered by timestamp (newest first), then by build number (highest first).
         Returns empty list if no builds match the criteria.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if jobFilter is null or buildCount is null or non-positive</dd>
<dt>Since:</dt>
<dd>1.0</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>table schema</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findLatestInsights(java.lang.String,java.lang.Integer)">
<h3>findLatestInsights</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT content-&gt;\'insights\' AS insights FROM chat_messages WHERE conversation_id = :conversationId   AND build_number = :buildNumber   AND message_type = \'ASSISTANT\' ORDER BY timestamp DESC LIMIT 1",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</span>&nbsp;<span class="element-name">findLatestInsights</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</span></div>
<div class="block">Retrieves AI-generated insights for a specific build from analysis results.

 <p>This method extracts the insights section from AI analysis results, containing
 summary information, recommendations, and trend analysis for a specific build.
 It's used to provide actionable intelligence about build quality and patterns.</p>

 <p><strong>JSONB Path Extraction:</strong></p>
 <ul>
   <li><strong>content-&gt;'insights':</strong> Extracts entire insights object from JSONB</li>
   <li><strong>ORDER BY timestamp DESC:</strong> Ensures latest analysis if multiple exist</li>
   <li><strong>LIMIT 1:</strong> Returns only the most recent insights</li>
 </ul>

 <p><strong>Insights Structure:</strong></p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "summary": "Overall build analysis summary",
  "recommendations": [
    "Fix security vulnerability in authentication module",
    "Optimize database queries for better performance",
    "Update deprecated dependencies"
  ],
  "trends": {
    "pattern": "improving|stable|deteriorating",
    "direction": "positive|negative|neutral",
    "confidence": 0.85
  },
  "keyFindings": [
    "No critical security issues detected",
    "Performance improved by 15% from previous build"
  ]
}
</code></pre>
</div>


 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Service:</strong> Called by DashboardService.getAiInsights()</li>
   <li><strong>Build Detail View:</strong> Powers insights section in build details</li>
   <li><strong>Recommendation Engine:</strong> Provides actionable recommendations</li>
   <li><strong>Trend Analysis:</strong> Enables pattern recognition across builds</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dd><code>buildNumber</code> - the specific build number to analyze</dd>
<dt>Returns:</dt>
<dd>Map containing insights JSONB object, or null if no insights found</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findLatestInsightsByConversation(java.lang.String)"><code>findLatestInsightsByConversation(String)</code></a></li>
<li><a href="#findRiskScore(java.lang.String,java.lang.Integer)"><code>findRiskScore(String, Integer)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findLatestInsightsByConversation(java.lang.String)">
<h3>findLatestInsightsByConversation</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT content-&gt;\'insights\' AS insights FROM chat_messages WHERE conversation_id = :conversationId   AND message_type = \'ASSISTANT\' ORDER BY timestamp DESC LIMIT 1",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</span>&nbsp;<span class="element-name">findLatestInsightsByConversation</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId)</span></div>
<div class="block">Retrieves the most recent AI-generated insights for a conversation (job) across all builds.

 <p>This method extracts insights from the latest AI analysis for a specific Jenkins job,
 regardless of build number. It's useful for getting the most current insights about
 a job's overall health and trends when specific build context isn't required.</p>

 <p><strong>Query Characteristics:</strong></p>
 <ul>
   <li><strong>Cross-Build Search:</strong> Searches across all builds for the job</li>
   <li><strong>Latest Analysis:</strong> Returns insights from most recent AI analysis</li>
   <li><strong>Job-Level View:</strong> Provides job-wide insights rather than build-specific</li>
   <li><strong>Fallback Option:</strong> Used when specific build insights aren't available</li>
 </ul>

 <p><strong>Comparison with findLatestInsights:</strong></p>
 <ul>
   <li><strong>findLatestInsights:</strong> Build-specific insights (includes build_number filter)</li>
   <li><strong>findLatestInsightsByConversation:</strong> Job-wide insights (no build_number filter)</li>
   <li><strong>Use Case:</strong> Job overview vs specific build analysis</li>
 </ul>

 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Service:</strong> Called by DashboardService.getAiInsightsByConversation()</li>
   <li><strong>Job Overview:</strong> Powers job-level insights in dashboard</li>
   <li><strong>Fallback Mechanism:</strong> Used when build-specific insights unavailable</li>
   <li><strong>Job Health Summary:</strong> Provides overall job health assessment</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dt>Returns:</dt>
<dd>Map containing insights JSONB object from latest analysis, or null if none found</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#findLatestInsights(java.lang.String,java.lang.Integer)"><code>findLatestInsights(String, Integer)</code></a></li>
<li><a href="#findBuildSummary(java.lang.String,java.lang.Integer)"><code>findBuildSummary(String, Integer)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findJobsByStatus(java.lang.String)">
<h3>findJobsByStatus</h3>
<div class="member-signature"><span class="annotations">@Query(value="WITH latest_messages AS (     SELECT DISTINCT ON (cm.conversation_id, cm.build_number)         cm.conversation_id,         cm.build_number,         cm.timestamp,         COALESCE(             NULLIF(cm.content -&gt; \'buildMetadata\' -&gt;&gt; \'status\', \'\'),             NULLIF(cm.content -&gt; \'data\' -&gt; \'build_info\' -&gt;&gt; \'result\', \'\'),             \'UNKNOWN\'         ) AS build_status     FROM chat_messages cm     WHERE COALESCE(             NULLIF(cm.content -&gt; \'buildMetadata\' -&gt;&gt; \'status\', \'\'),             NULLIF(cm.content -&gt; \'data\' -&gt; \'build_info\' -&gt;&gt; \'result\', \'\'),             \'UNKNOWN\'         ) != \'UNKNOWN\'     ORDER BY cm.conversation_id, cm.build_number, cm.timestamp DESC ), latest_builds AS (     SELECT DISTINCT ON (lm.conversation_id)         lm.conversation_id,         lm.build_number,         lm.timestamp,         lm.build_status     FROM latest_messages lm     ORDER BY lm.conversation_id, lm.build_number DESC ), relevant_builds AS (     SELECT         lb.conversation_id,         lb.build_number,         lb.timestamp,         lb.build_status,         COALESCE(bas.total_anomalies, 0) AS total_anomalies,         COALESCE(abc.active_builds, 0) &gt; 0 AS is_active     FROM latest_builds lb     LEFT JOIN build_anomaly_summary bas ON lb.conversation_id = bas.conversation_id AND lb.build_number = bas.build_number     LEFT JOIN active_build_counts abc ON lb.conversation_id = abc.job_filter ) SELECT     rb.conversation_id AS job_name,     rb.build_number || \' - \' ||     CASE         WHEN EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) &lt; 3600 THEN FLOOR(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) / 60) || \' minutes ago\'         WHEN EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) &lt; 86400 THEN FLOOR(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) / 3600) || \' hours ago\'         WHEN EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) &lt; 2592000 THEN FLOOR(EXTRACT(EPOCH FROM (CURRENT_TIMESTAMP - rb.timestamp)) / 86400) || \' days ago\'         ELSE TO_CHAR(rb.timestamp, \'YYYY-MM-DD HH24:MI\')     END AS last_build,     CASE         WHEN rb.is_active THEN \'RUNNING\'         WHEN rb.build_status = \'SUCCESS\' THEN \'COMPLETED\'         WHEN rb.build_status IN (\'FAILURE\', \'ABORTED\', \'UNSTABLE\') THEN \'FAILED\'         ELSE rb.build_status     END AS status,     rb.total_anomalies AS anomalies FROM relevant_builds rb WHERE (:statusFilter = \'all\'        OR (:statusFilter = \'active\' AND rb.is_active)        OR (:statusFilter = \'completed\' AND NOT rb.is_active AND rb.build_status = \'SUCCESS\')        OR (:statusFilter = \'completedwithissues\' AND NOT rb.is_active AND rb.build_status = \'SUCCESS\' AND rb.total_anomalies &gt; 0)        OR (:statusFilter = \'withissues\' AND (rb.total_anomalies &gt; 0 OR rb.build_status IN (\'FAILURE\', \'ABORTED\', \'UNSTABLE\')))) ORDER BY rb.timestamp DESC",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&gt;</span>&nbsp;<span class="element-name">findJobsByStatus</span><wbr><span class="parameters">(@Param("statusFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;statusFilter)</span></div>
<div class="block">Retrieves job status information with comprehensive filtering capabilities.

 <p>This complex query performs a multi-step analysis of job/build data:</p>
 <ol>
   <li><b>latest_messages</b>: Gets the most recent chat message for each build with known status</li>
   <li><b>latest_builds</b>: Identifies the most recent build for each job</li>
   <li><b>relevant_builds</b>: Enriches build data with anomaly counts and active status</li>
   <li><b>final selection</b>: Formats the output with human-readable timestamps and status categories</li>
 </ol>


 <p>The query returns a list of maps containing these fields:</p>
 <ul>
   <li><b>job_name</b>: The conversation/job identifier</li>
   <li><b>last_build</b>: Formatted build timestamp (relative time or absolute)</li>
   <li><b>status</b>: Categorized build status (RUNNING, COMPLETED, FAILED, etc.)</li>
   <li><b>anomalies</b>: Count of detected anomalies (0 if none)</li>
 </ul>


 <p><b>Filtering Options:</b></p>
 <ul>
   <li><b>all</b>: Returns all jobs regardless of status</li>
   <li><b>active</b>: Only currently running jobs</li>
   <li><b>completed</b>: Successfully completed jobs without anomalies</li>
   <li><b>completedwithissues</b>: Completed successfully but with anomalies</li>
   <li><b>withissues</b>: Any job with anomalies or failure status</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>statusFilter</code> - The filter criteria to apply. Must be one of:
                    "all", "active", "completed", "completedwithissues", or "withissues".
                    Case-sensitive. Must not be <code>null</code>.</dd>
<dt>Returns:</dt>
<dd>List of job status maps, each containing keys: "job_name", "last_build",
         "status", and "anomalies". Returns empty list if no matches found.
         Results ordered by timestamp (newest first).</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>statusFilter</code> is <code>null</code> or invalid</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dd><code>jakarta.persistence.QueryTimeoutException</code> - if the query times out</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Query</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findJobCountByTimeBoundary(java.lang.String)">
<h3>findJobCountByTimeBoundary</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT time_boundary AS timeBoundary,        total_jobs AS totalJobs,        computed_at AS computedAt FROM job_counts WHERE time_boundary = :timeBoundary",
       nativeQuery=true)
</span><span class="return-type"><a href="../dto/JobCountProjection.html" title="interface in com.diploma.inno.dto">JobCountProjection</a></span>&nbsp;<span class="element-name">findJobCountByTimeBoundary</span><wbr><span class="parameters">(@Param("timeBoundary")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;timeBoundary)</span></div>
<div class="block">Retrieves job count statistics for a specific time boundary from the database.

 <p>Executes a native SQL query that selects three columns from the <code>job_counts</code> table
 and maps them to a <a href="../dto/JobCountProjection.html" title="interface in com.diploma.inno.dto"><code>JobCountProjection</code></a> interface:</p>
 <ul>
   <li><code>time_boundary</code> (aliased as <code>timeBoundary</code>) - The time period identifier (e.g., daily, weekly)</li>
   <li><code>total_jobs</code> (aliased as <code>totalJobs</code>) - The total number of jobs counted</li>
   <li><code>computed_at</code> (aliased as <code>computedAt</code>) - The timestamp when the count was computed</li>
 </ul>


 <p><b>Note:</b> This is a read-only operation that expects the <code>timeBoundary</code> parameter</p>
 <p>to match exactly one record in the database. The query uses column aliasing to match the</p>
 <p>projection interface's property names.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>timeBoundary</code> - the time boundary identifier used to select the statistics record.
                    Must not be <code>null</code> or empty. Example values: "daily", "weekly", "monthly".</dd>
<dt>Returns:</dt>
<dd>a <a href="../dto/JobCountProjection.html" title="interface in com.diploma.inno.dto"><code>JobCountProjection</code></a> containing the job count statistics for the specified
         time boundary, or <code>null</code> if no matching record is found.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>timeBoundary</code> is <code>null</code> or empty</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dd><code>jakarta.persistence.NonUniqueResultException</code> - if multiple records match the time boundary</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Query</code></li>
<li><a href="../dto/JobCountProjection.html" title="interface in com.diploma.inno.dto"><code>JobCountProjection</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findActiveBuildCountByJobFilter(java.lang.String)">
<h3>findActiveBuildCountByJobFilter</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT job_filter AS jobFilter,        active_builds AS activeBuilds,        computed_at AS computedAt FROM active_build_counts WHERE job_filter = :jobFilter",
       nativeQuery=true)
</span><span class="return-type"><a href="../dto/ActiveBuildCountProjection.html" title="interface in com.diploma.inno.dto">ActiveBuildCountProjection</a></span>&nbsp;<span class="element-name">findActiveBuildCountByJobFilter</span><wbr><span class="parameters">(@Param("jobFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter)</span></div>
<div class="block">Retrieves active build count statistics for a specific job filter from the database.

 <p>This method executes a native SQL query that selects three specific columns from the
 <code>active_build_counts</code> table and maps them to an <a href="../dto/ActiveBuildCountProjection.html" title="interface in com.diploma.inno.dto"><code>ActiveBuildCountProjection</code></a>:</p>
 <ul>
   <li><code>job_filter</code> (aliased as <code>jobFilter</code>)</li>
   <li><code>active_builds</code> (aliased as <code>activeBuilds</code>)</li>
   <li><code>computed_at</code> (aliased as <code>computedAt</code>)</li>
 </ul>


 <p><b>Note:</b> This is a read-only operation that doesn't modify the database state.
 The query uses column aliasing to match the projection interface's property names.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobFilter</code> - the job filter string used to identify the specific record to retrieve.
                 Must not be <code>null</code> or empty.</dd>
<dt>Returns:</dt>
<dd>an <a href="../dto/ActiveBuildCountProjection.html" title="interface in com.diploma.inno.dto"><code>ActiveBuildCountProjection</code></a> containing the job filter, active builds count,
         and computation timestamp. Returns <code>null</code> if no matching record is found.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if <code>jobFilter</code> is <code>null</code> or empty</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Query</code></li>
<li><a href="../dto/ActiveBuildCountProjection.html" title="interface in com.diploma.inno.dto"><code>ActiveBuildCountProjection</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findSecurityAnomalyCountByJobFilterAndTimeRange(java.lang.String,java.lang.String)">
<h3>findSecurityAnomalyCountByJobFilterAndTimeRange</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT job_filter AS jobFilter,        anomaly_count AS anomalyCount,        time_range AS timeRange,        computed_at AS computedAt FROM security_anomaly_counts WHERE job_filter = :jobFilter AND time_range = :timeRange",
       nativeQuery=true)
</span><span class="return-type"><a href="../dto/SecurityAnomalyCountProjection.html" title="interface in com.diploma.inno.dto">SecurityAnomalyCountProjection</a></span>&nbsp;<span class="element-name">findSecurityAnomalyCountByJobFilterAndTimeRange</span><wbr><span class="parameters">(@Param("jobFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 @Param("timeRange")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;timeRange)</span></div>
<div class="block">Retrieves security anomaly count statistics for a specific job filter and time range combination.

 <p>Executes a native SQL query that selects four columns from the <code>security_anomaly_counts</code> table
 and maps them to a <a href="../dto/SecurityAnomalyCountProjection.html" title="interface in com.diploma.inno.dto"><code>SecurityAnomalyCountProjection</code></a> interface:</p>
 <ul>
   <li><code>job_filter</code> (aliased as <code>jobFilter</code>) - The job filter identifier</li>
   <li><code>anomaly_count</code> (aliased as <code>anomalyCount</code>) - The count of security anomalies</li>
   <li><code>time_range</code> (aliased as <code>timeRange</code>) - The time period these statistics cover</li>
   <li><code>computed_at</code> (aliased as <code>computedAt</code>) - When these statistics were calculated</li>
 </ul>


 <p><b>Note:</b> This query requires both parameters to match exactly one record in the database.
 The combination of <code>jobFilter</code> and <code>timeRange</code> should be unique in the table.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobFilter</code> - the job filter string used to identify the specific security statistics record.
                 Must not be <code>null</code> or empty.</dd>
<dd><code>timeRange</code> - the time range string (e.g., "7d", "30d") specifying which period's statistics to retrieve.
                 Must not be <code>null</code> or empty.</dd>
<dt>Returns:</dt>
<dd>a <a href="../dto/SecurityAnomalyCountProjection.html" title="interface in com.diploma.inno.dto"><code>SecurityAnomalyCountProjection</code></a> containing the security anomaly statistics,
         or <code>null</code> if no matching record is found for the given parameters.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if either <code>jobFilter</code> or <code>timeRange</code> is <code>null</code> or empty</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dd><code>jakarta.persistence.NonUniqueResultException</code> - if multiple records match the criteria</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Query</code></li>
<li><a href="../dto/SecurityAnomalyCountProjection.html" title="interface in com.diploma.inno.dto"><code>SecurityAnomalyCountProjection</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findRecentJobBuildsByJobName(java.lang.String)">
<h3>findRecentJobBuildsByJobName</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT job_name AS jobName,        build_id AS buildId,        health_status AS healthStatus,        anomaly_count AS anomalyCount,        time_ago AS timeAgo,        raw_timestamp AS rawTimestamp,        computed_at AS computedAt,        original_job_name AS originalJobName FROM recent_job_builds WHERE job_name = :jobName ORDER BY raw_timestamp DESC",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../dto/RecentJobBuildProjection.html" title="interface in com.diploma.inno.dto">RecentJobBuildProjection</a>&gt;</span>&nbsp;<span class="element-name">findRecentJobBuildsByJobName</span><wbr><span class="parameters">(@Param("jobName")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobName)</span></div>
<div class="block">Retrieves recent builds for a specific job, ordered chronologically (newest first).

 <p>This native query selects all build records from the <code>recent_job_builds</code> table
 matching the specified job name, with the following field mappings:</p>
 <ul>
   <li><code>job_name</code> → <code>jobName</code></li>
   <li><code>build_id</code> → <code>buildId</code></li>
   <li><code>health_status</code> → <code>healthStatus</code></li>
   <li><code>anomaly_count</code> → <code>anomalyCount</code></li>
   <li><code>time_ago</code> → <code>timeAgo</code> (human-readable time since build)</li>
   <li><code>raw_timestamp</code> → <code>rawTimestamp</code> (exact build timestamp)</li>
   <li><code>computed_at</code> → <code>computedAt</code> (when record was generated)</li>
   <li><code>original_job_name</code> → <code>originalJobName</code> (source system job name)</li>
 </ul>


 <p><b>Ordering:</b> Results are always sorted by <code>raw_timestamp</code> in descending order
 (newest builds first).</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobName</code> - The exact job name to filter by. Must match exactly (case-sensitive).
               Null values will be filtered out by the query.</dd>
<dt>Returns:</dt>
<dd>A non-null List of <a href="../dto/RecentJobBuildProjection.html" title="interface in com.diploma.inno.dto"><code>RecentJobBuildProjection</code></a> objects containing build details.
         Returns empty list if:
         <ul>
           <li>No builds exist for the job</li>
           <li>Job name doesn't match any records</li>
         </ul></dd>
<dt>Throws:</dt>
<dd><code>jakarta.persistence.PersistenceException</code> - if query execution fails</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../dto/RecentJobBuildProjection.html" title="interface in com.diploma.inno.dto"><code>RecentJobBuildProjection</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findDistinctJobNames()">
<h3>findDistinctJobNames</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT DISTINCT job_name FROM chat_messages WHERE job_name IS NOT NULL ORDER BY job_name",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">findDistinctJobNames</span>()</div>
<div class="block">Retrieves all distinct job names from the chat messages table.

 <p>This native query:</p>
 <ul>
   <li>Selects only non-null job names from <code>chat_messages</code> table</li>
   <li>Returns unique values (DISTINCT)</li>
   <li>Orders results alphabetically by job name</li>
   <li>Uses case-sensitive sorting</li>
 </ul>


 <p><b>Note:</b> The list represents all jobs that have ever generated chat messages,
 not necessarily currently active jobs.</p></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A non-null, alphabetically ordered List of distinct job names as Strings.
         Returns empty list if no job messages exist or all job_name values are null.</dd>
<dt>Throws:</dt>
<dd><code>jakarta.persistence.PersistenceException</code> - if query execution fails</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteByJobNameIn(java.util.Collection)">
<h3>deleteByJobNameIn</h3>
<div class="member-signature"><span class="annotations">@Transactional
@Modifying
@Query(value="DELETE FROM chat_messages WHERE job_name IN :jobNames",
       nativeQuery=true)
</span><span class="return-type">void</span>&nbsp;<span class="element-name">deleteByJobNameIn</span><wbr><span class="parameters">(@Param("jobNames")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html" title="class or interface in java.util" class="external-link">Collection</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;&nbsp;jobNames)</span></div>
<div class="block">Deletes all chat messages associated with the given collection of job names in a single transaction.

 <p>This method performs a bulk delete operation directly in the database using a native SQL query,
 which is more efficient than deleting entities one by one. The operation is executed within a
 transactional context and modifies the database state.</p>

 <p><b>Note:</b> This is a modifying query that bypasses JPA's entity lifecycle events (like @PreRemove).
 Cache eviction and other side effects might need to be handled manually if required.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobNames</code> - a collection of job names identifying the messages to be deleted.
                 Must not be <code>null</code>. If empty, no deletions will occur.</dd>
<dt>Throws:</dt>
<dd><code>jakarta.persistence.TransactionRequiredException</code> - if no transaction is active</dd>
<dd><code>jakarta.persistence.PersistenceException</code> - if the query execution fails</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>Transactional</code></li>
<li><code>Modifying</code></li>
<li><code>Query</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getTrackingLogInfo(java.lang.String,java.lang.Integer)">
<h3>getTrackingLogInfo</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT COUNT(*) FROM chat_messages WHERE message_type = \'USER\' AND conversation_id = :conversationId AND build_number = :buildNumber",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a></span>&nbsp;<span class="element-name">getTrackingLogInfo</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber)</span></div>
<div class="block">Counts USER messages (build logs) for tracking log collection progress.

 <p>This method provides a count of received log messages for a specific build,
 which is used to track log collection progress and determine completion status.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - The conversation identifier (Jenkins job name)</dd>
<dd><code>buildNumber</code> - The specific build number</dd>
<dt>Returns:</dt>
<dd>Count of USER messages (build logs) received for the build</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#countByConversationIdAndBuildNumberAndContentContaining(java.lang.String,int)"><code>countByConversationIdAndBuildNumberAndContentContaining(String, int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="findAllUserLogsByJobAndBuildWithPagination(java.lang.String,java.lang.Integer,java.lang.Integer,java.lang.Integer)">
<h3>findAllUserLogsByJobAndBuildWithPagination</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT content FROM chat_messages WHERE message_type = \'USER\' AND conversation_id = :conversationId AND build_number = :buildNumber AND NOT jsonb_exists(content, \'instructions\') ORDER BY timestamp LIMIT :limit OFFSET :offset",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&gt;</span>&nbsp;<span class="element-name">findAllUserLogsByJobAndBuildWithPagination</span><wbr><span class="parameters">(@Param("conversationId")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;conversationId,
 @Param("buildNumber")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;buildNumber,
 @Param("limit")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;limit,
 @Param("offset")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&nbsp;offset)</span></div>
<div class="block">Retrieves paginated build logs (USER messages) for a specific job and build with instruction filtering.

 <p>This method implements efficient pagination for build log retrieval, filtering out instruction
 messages to return only actual build log content. It's designed for high-performance log browsing
 in the dashboard interface where users need to examine build logs in manageable chunks.</p>

 <p><strong>Filtering Logic:</strong></p>
 <ul>
   <li><strong>message_type = 'USER':</strong> Only retrieves build log messages</li>
   <li><strong>NOT jsonb_exists(content, 'instructions'):</strong> Excludes instruction/control messages</li>
   <li><strong>conversation_id + build_number:</strong> Targets specific build logs</li>
   <li><strong>ORDER BY timestamp:</strong> Maintains chronological log order</li>
 </ul>

 <p><strong>JSONB Operations:</strong></p>
 <ul>
   <li><strong>jsonb_exists:</strong> Checks for presence of 'instructions' key in JSONB</li>
   <li><strong>NOT operator:</strong> Inverts the existence check to exclude instructions</li>
   <li><strong>Content extraction:</strong> Returns raw JSONB content as string</li>
 </ul>

 <p><strong>Pagination Parameters:</strong></p>
 <ul>
   <li><strong>LIMIT :limit:</strong> Controls number of log entries per page</li>
   <li><strong>OFFSET :offset:</strong> Skips to correct page position (pageNumber * pageSize)</li>
   <li><strong>Chronological Order:</strong> Ensures logs appear in execution order</li>
 </ul>

 <p><strong>Expected Log Content Structure:</strong></p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "build_log_data",
  "log_chunk": "Started by user admin\nRunning as SYSTEM\n...",
  "chunk_index": 1,
  "total_chunks": 14,
  "timestamp": "2024-01-15T10:30:00Z"
}
</code></pre>
</div>


 <p><strong>Performance Characteristics:</strong></p>
 <ul>
   <li><strong>Efficient Pagination:</strong> Only loads requested page of logs</li>
   <li><strong>Index Utilization:</strong> Uses composite index on (conversation_id, build_number)</li>
   <li><strong>Memory Efficient:</strong> Streams results without loading entire log set</li>
   <li><strong>JSONB Optimization:</strong> Leverages PostgreSQL's optimized JSONB operations</li>
 </ul>

 <p><strong>Usage Context:</strong></p>
 <ul>
   <li><strong>Dashboard Service:</strong> Called by DashboardService.getAllLogs()</li>
   <li><strong>Log Viewer:</strong> Powers paginated log browsing interface</li>
   <li><strong>Build Analysis:</strong> Enables detailed examination of build execution</li>
   <li><strong>Debugging:</strong> Provides access to raw build logs for troubleshooting</li>
 </ul>

 <p><strong>Integration with Log Collection:</strong></p>
 <ul>
   <li><strong>Expected Chunks:</strong> Typically 14 chunks per build (total_chunks field)</li>
   <li><strong>Progress Tracking:</strong> Used with getTrackingLogInfo() for completion status</li>
   <li><strong>Chronological Order:</strong> Maintains original Jenkins log sequence</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>conversationId</code> - the Jenkins job name (conversation identifier)</dd>
<dd><code>buildNumber</code> - the specific build number to retrieve logs for</dd>
<dd><code>limit</code> - the number of log entries to return per page</dd>
<dd><code>offset</code> - the number of log entries to skip (pageNumber * pageSize)</dd>
<dt>Returns:</dt>
<dd>List of JSONB content strings containing build log data</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#getTrackingLogInfo(java.lang.String,java.lang.Integer)"><code>getTrackingLogInfo(String, Integer)</code></a></li>
<li><a href="#countByConversationIdAndBuildNumberAndContentContaining(java.lang.String,int)"><code>countByConversationIdAndBuildNumberAndContentContaining(String, int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getAllMessagesForTrend(java.time.Instant,java.time.Instant)">
<h3>getAllMessagesForTrend</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT DATE_TRUNC(\'day\', timestamp) AS date, content\nFROM chat_messages\nWHERE message_type = \'ASSISTANT\'\n  AND timestamp &gt;= :startTime\n  AND timestamp &lt;= :endTime\nORDER BY date\n",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]&gt;</span>&nbsp;<span class="element-name">getAllMessagesForTrend</span><wbr><span class="parameters">(@Param("startTime")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;startTime,
 @Param("endTime")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;endTime)</span></div>
<div class="block">Retrieves all ASSISTANT messages with content for trend analysis across all jobs.

 <p>This method fetches AI analysis messages grouped by day for trend analysis.
 Used for generating time-series data and identifying patterns in build analysis.</p>

 <p><strong>SQL Features:</strong></p>
 <ul>
   <li>Uses <code>DATE_TRUNC('day', timestamp)</code> for daily grouping</li>
   <li>Returns both date and content for flexible analysis</li>
   <li>Ordered by date for chronological processing</li>
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>startTime</code> - Start of the analysis period</dd>
<dd><code>endTime</code> - End of the analysis period</dd>
<dt>Returns:</dt>
<dd>List of Object arrays containing [date, content] pairs</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#getMessagesForTrendByJob(java.lang.String,java.time.Instant,java.time.Instant)"><code>getMessagesForTrendByJob(String, Instant, Instant)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMessagesForTrendByJob(java.lang.String,java.time.Instant,java.time.Instant)">
<h3>getMessagesForTrendByJob</h3>
<div class="member-signature"><span class="annotations">@Query(value="SELECT DATE_TRUNC(\'day\', timestamp) AS date, content\nFROM chat_messages\nWHERE message_type = \'ASSISTANT\'\n  AND conversation_id = :jobFilter\n  AND timestamp &gt;= :startTime\n  AND timestamp &lt;= :endTime\nORDER BY date\n",
       nativeQuery=true)
</span><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>[]&gt;</span>&nbsp;<span class="element-name">getMessagesForTrendByJob</span><wbr><span class="parameters">(@Param("jobFilter")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobFilter,
 @Param("startTime")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;startTime,
 @Param("endTime")
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/time/Instant.html" title="class or interface in java.time" class="external-link">Instant</a>&nbsp;endTime)</span></div>
<div class="block">Retrieves ASSISTANT messages with content for trend analysis for a specific job.

 <p>This method is the job-specific version of trend analysis, providing
 daily-grouped AI analysis data for a particular Jenkins job.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobFilter</code> - The specific job name to analyze</dd>
<dd><code>startTime</code> - Start of the analysis period</dd>
<dd><code>endTime</code> - End of the analysis period</dd>
<dt>Returns:</dt>
<dd>List of Object arrays containing [date, content] pairs for the specified job</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#getAllMessagesForTrend(java.time.Instant,java.time.Instant)"><code>getAllMessagesForTrend(Instant, Instant)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
