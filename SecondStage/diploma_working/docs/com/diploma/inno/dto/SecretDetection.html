<!DOCTYPE HTML>
<html lang="ru">
<head>
<!-- Generated by javadoc (21) on Fri Jun 06 16:44:09 SAMT 2025 -->
<title>SecretDetection</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2025-06-06">
<meta name="description" content="declaration: package: com.diploma.inno.dto, class: SecretDetection">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/SecretDetection.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.diploma.inno.dto</a></div>
<h1 title="Class SecretDetection" class="title">Class SecretDetection</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="TypedLog.html" title="class in com.diploma.inno.dto">com.diploma.inno.dto.TypedLog</a>
<div class="inheritance">com.diploma.inno.dto.SecretDetection</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="Log.html" title="interface in com.diploma.inno.dto">Log</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">SecretDetection</span>
<span class="extends-implements">extends <a href="TypedLog.html" title="class in com.diploma.inno.dto">TypedLog</a></span></div>
<div class="block">Data Transfer Object for secret detection &amp; credential scanning results in CI/CD security analysis.

 <p>This DTO encapsulates comprehensive secret detection results including exposed credentials,
 API keys, tokens, passwords, and other sensitive information found in source code, configuration
 files, and build artifacts. It serves as a critical component for preventing credential leaks,
 ensuring security compliance, and enabling AI-powered analysis of secret exposure risks
 across CI/CD pipelines.</p>

 <h2 id="core-functionality-heading">Core Functionality</h2>
 <ul>
   <li><strong>Secret Detection:</strong> Identifies exposed credentials, API keys &amp; sensitive data</li>
   <li><strong>Multi-Source Scanning:</strong> Scans source code, configs, logs &amp; build artifacts</li>
   <li><strong>Pattern Recognition:</strong> Advanced regex &amp; ML-based secret pattern detection</li>
   <li><strong>Content Analysis:</strong> Deep analysis of file contents &amp; commit history</li>
   <li><strong>Compression Support:</strong> Handles GZIP-compressed content for large datasets</li>
   <li><strong>Risk Assessment:</strong> Categorizes secrets by type &amp; exposure risk level</li>
 </ul>

 <h2 id="secret-types-detection-heading">Secret Types &amp; Detection</h2>
 <p>The DTO supports detection of various types of sensitive information:</p>
 <ul>
   <li><strong>API Keys:</strong> AWS, Google Cloud, Azure, GitHub, Slack API keys</li>
   <li><strong>Database Credentials:</strong> MySQL, PostgreSQL, MongoDB connection strings</li>
   <li><strong>Authentication Tokens:</strong> JWT tokens, OAuth tokens, session tokens</li>
   <li><strong>Private Keys:</strong> SSH keys, SSL certificates, PGP private keys</li>
   <li><strong>Passwords:</strong> Hardcoded passwords, service account credentials</li>
   <li><strong>Cloud Secrets:</strong> Docker registry tokens, Kubernetes secrets</li>
 </ul>

 <h2 id="json-structure-serialization-heading">JSON Structure &amp; Serialization</h2>
 <p>The DTO supports comprehensive JSON serialization for data exchange:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "secret_detection",
  "job_name": "security-scan-pipeline",
  "build_number": 123,
  "data": {
    "source": "src/main/resources/application.properties",
    "message": "Secret detection scan completed",
    "content_compressed": false,
    "content": "database.password=mySecretPassword123\napi.key=sk-1234567890abcdef",
    "secrets_compressed": false,
    "secrets": {
      "database_password": ["mySecretPassword123"],
      "api_key": ["sk-1234567890abcdef"],
      "aws_access_key": ["AKIAIOSFODNN7EXAMPLE"]
    }
  },
  "error": null,
  "timestamp": "2024-01-15T10:30:00Z"
}
</code></pre>
</div>


 <h2 id="compressed-content-handling-heading">Compressed Content Handling</h2>
 <p>For large files or extensive secret scans, the DTO supports GZIP compression:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "secret_detection",
  "job_name": "enterprise-secret-scan",
  "build_number": 456,
  "data": {
    "source": "entire_repository_scan",
    "message": "Full repository secret scan with 500+ files",
    "content_compressed": true,
    "content": "H4sIAAAAAAAA/62QwQrCMBBE7+UrHnuxVqsHwYMf4MmTJ...",
    "secrets_compressed": true,
    "secrets": "H4sIAAAAAAAA/3WQwQrCMBBE7+UrHnuxVqsHwYMf4MmTJ..."
  },
  "error": null
}
</code></pre>
</div>


 <h2 id="error-handling-diagnostics-heading">Error Handling &amp; Diagnostics</h2>
 <p>When secret detection errors occur, the DTO captures diagnostic information:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "secret_detection",
  "job_name": "failing-secret-scan",
  "build_number": 789,
  "data": {
    "source": "protected_repository",
    "message": "Access denied to private repository",
    "content": "",
    "secrets": {}
  },
  "error": "Repository access denied: Insufficient permissions for secret scanning"
}
</code></pre>
</div>


 <h2 id="ai-analysis-integration-heading">AI Analysis Integration</h2>
 <p>The DTO provides structured content for AI-powered security analysis:</p>
 <ul>
   <li><strong>Risk Assessment:</strong> AI-driven evaluation of secret exposure severity</li>
   <li><strong>False Positive Reduction:</strong> ML-based filtering of test/dummy credentials</li>
   <li><strong>Pattern Learning:</strong> Adaptive pattern recognition for new secret types</li>
   <li><strong>Compliance Monitoring:</strong> Automated compliance checking &amp; reporting</li>
   <li><strong>Remediation Guidance:</strong> AI-generated recommendations for secret management</li>
 </ul>

 <h2 id="security-metrics-kpis-heading">Security Metrics &amp; KPIs</h2>
 <p>The DTO enables comprehensive security metrics tracking:</p>
 <ul>
   <li><strong>Secret Counts:</strong> Total secrets found by type &amp; severity</li>
   <li><strong>Exposure Trends:</strong> Historical secret detection trends &amp; improvements</li>
   <li><strong>Source Analysis:</strong> Secret distribution across files &amp; repositories</li>
   <li><strong>Remediation Tracking:</strong> Time-to-fix metrics &amp; resolution effectiveness</li>
 </ul>

 <h2 id="source-context-traceability-heading">Source Context &amp; Traceability</h2>
 <p>The DTO maintains crucial source context for secret tracking:</p>
 <ul>
   <li><strong>File Identification:</strong> Specific files &amp; locations containing secrets</li>
   <li><strong>Repository Context:</strong> Repository-wide secret scanning &amp; analysis</li>
   <li><strong>Commit Correlation:</strong> Links secret findings to specific code changes</li>
   <li><strong>Multi-Source Support:</strong> Handles secrets across multiple sources &amp; formats</li>
 </ul>

 <h2 id="performance-optimization-heading">Performance Optimization</h2>
 <ul>
   <li><strong>Compression Support:</strong> GZIP compression for large content &amp; secret datasets</li>
   <li><strong>Lazy Decompression:</strong> Decompresses content only when needed for analysis</li>
   <li><strong>Memory Efficiency:</strong> Optimized handling of large file scans</li>
   <li><strong>Streaming Processing:</strong> Efficient processing of continuous secret detection</li>
 </ul>

 <h2 id="integration-points-heading">Integration Points</h2>
 <p>This DTO integrates with multiple system components:</p>
 <ul>
   <li><strong>LogMessageListener:</strong> Receives &amp; processes secret detection messages</li>
   <li><strong>SimpleDbChatMemory:</strong> Stores secret detection results for analysis</li>
   <li><strong>AI Analysis Engine:</strong> Provides secret data for security analysis</li>
   <li><strong>Security Dashboard:</strong> Supplies real-time secret exposure metrics</li>
 </ul></div>
<dl class="notes">
<dt>Since:</dt>
<dd>1.0</dd>
<dt>Version:</dt>
<dd>1.0</dd>
<dt>Author:</dt>
<dd>Khasan Abdurakhmanov</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TypedLog.html" title="class in com.diploma.inno.dto"><code>TypedLog</code></a></li>
<li><a href="../component/LogMessageListener.html" title="class in com.diploma.inno.component"><code>LogMessageListener</code></a></li>
<li><a href="../component/SimpleDbChatMemory.html" title="class in com.diploma.inno.component"><code>SimpleDbChatMemory</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">SecretDetection</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Default constructor initializing the DTO with proper type identification.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getBuildNumber()" class="member-name-link">getBuildNumber</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the Jenkins build number for this secret detection result.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getContentToAnalyze()" class="member-name-link">getContentToAnalyze</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Generates structured content for AI-powered secret detection analysis &amp; security assessment.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getConversationId()" class="member-name-link">getConversationId</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Provides the conversation identifier for chat memory correlation.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a><wbr>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getData()" class="member-name-link">getData</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the complex data structure containing secret detection information and metadata.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getError()" class="member-name-link">getError</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the error message or diagnostic information.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getJobName()" class="member-name-link">getJobName</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the Jenkins job name associated with this secret detection result.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setBuildNumber(int)" class="member-name-link">setBuildNumber</a><wbr>(int&nbsp;buildNumber)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the Jenkins build number for this secret detection result.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setData(java.util.Map)" class="member-name-link">setData</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&nbsp;data)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the secret detection data and metadata.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setError(java.lang.String)" class="member-name-link">setError</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;error)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the error message or diagnostic information.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setJobName(java.lang.String)" class="member-name-link">setJobName</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobName)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the Jenkins job name for this secret detection result.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toJson()" class="member-name-link">toJson</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Converts the secret detection result to JSON format for data exchange &amp; storage.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a string representation of this SecretDetection object.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-com.diploma.inno.dto.TypedLog">Methods inherited from class&nbsp;com.diploma.inno.dto.<a href="TypedLog.html" title="class in com.diploma.inno.dto">TypedLog</a></h3>
<code><a href="TypedLog.html#getTimestamp()">getTimestamp</a>, <a href="TypedLog.html#getType()">getType</a>, <a href="TypedLog.html#setTimestamp(java.lang.String)">setTimestamp</a>, <a href="TypedLog.html#setType(java.lang.String)">setType</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>SecretDetection</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SecretDetection</span>()</div>
<div class="block">Default constructor initializing the DTO with proper type identification.

 <p>Creates a new SecretDetection instance with the type set to "secret_detection"
 for proper message routing and processing in the Jenkins anomaly detection pipeline.</p>

 <h4 id="initialization-process--heading">Initialization Process:</h4>
 <ol>
   <li>Sets the log type to "secret_detection" for message classification</li>
   <li>Logs initialization for debugging and audit purposes</li>
   <li>Prepares the instance for data population and serialization</li>
 </ol>

 <h4 id="usage-in-pipeline--heading">Usage in Pipeline:</h4>
 <p>This constructor is typically called during JSON deserialization when
 secret detection result messages are received via RabbitMQ:</p>

 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">// Automatic instantiation during JSON deserialization
SecretDetection secretDetection = objectMapper.readValue(jsonMessage, SecretDetection.class);

// Manual instantiation for testing
SecretDetection secretDetection = new SecretDetection();
secretDetection.setJobName("security-scan-pipeline");
secretDetection.setBuildNumber(123);

Map&lt;String, Object&gt; data = new HashMap&lt;&gt;();
data.put("source", "src/main/resources/application.properties");
data.put("content", "database.password=secret123");
Map&lt;String, List&lt;String&gt;&gt; secrets = new HashMap&lt;&gt;();
secrets.put("database_password", Arrays.asList("secret123"));
data.put("secrets", secrets);
secretDetection.setData(data);
</code></pre>
</div>
</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TypedLog.html#setType(java.lang.String)"><code>TypedLog.setType(String)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getJobName()">
<h3>getJobName</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getJobName</span>()</div>
<div class="block">Gets the Jenkins job name associated with this secret detection result.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the job name, or <code>null</code> if not set</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setJobName(java.lang.String)">
<h3>setJobName</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setJobName</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;jobName)</span></div>
<div class="block">Sets the Jenkins job name for this secret detection result.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>jobName</code> - the job name to set</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getBuildNumber()">
<h3>getBuildNumber</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getBuildNumber</span>()</div>
<div class="block">Gets the Jenkins build number for this secret detection result.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Log.html#getBuildNumber()">getBuildNumber</a></code>&nbsp;in interface&nbsp;<code><a href="Log.html" title="interface in com.diploma.inno.dto">Log</a></code></dd>
<dt>Overrides:</dt>
<dd><code><a href="TypedLog.html#getBuildNumber()">getBuildNumber</a></code>&nbsp;in class&nbsp;<code><a href="TypedLog.html" title="class in com.diploma.inno.dto">TypedLog</a></code></dd>
<dt>Returns:</dt>
<dd>the build number</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><code>JenkinsClient</code></li>
<li><code>JenkinsApi</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setBuildNumber(int)">
<h3>setBuildNumber</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setBuildNumber</span><wbr><span class="parameters">(int&nbsp;buildNumber)</span></div>
<div class="block">Sets the Jenkins build number for this secret detection result.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>buildNumber</code> - the build number to set</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getData()">
<h3>getData</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;</span>&nbsp;<span class="element-name">getData</span>()</div>
<div class="block">Gets the complex data structure containing secret detection information and metadata.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the data map containing secret detection details and metadata, or <code>null</code> if not set</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setData(java.util.Map)">
<h3>setData</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setData</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>&gt;&nbsp;data)</span></div>
<div class="block">Sets the secret detection data and metadata.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>data</code> - the data map to set, containing secret detection information and metadata</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getError()">
<h3>getError</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getError</span>()</div>
<div class="block">Gets the error message or diagnostic information.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the error message, or <code>null</code> if no error occurred</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setError(java.lang.String)">
<h3>setError</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setError</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;error)</span></div>
<div class="block">Sets the error message or diagnostic information.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>error</code> - the error message to set</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getContentToAnalyze()">
<h3>getContentToAnalyze</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getContentToAnalyze</span>()
                           throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></span></div>
<div class="block">Generates structured content for AI-powered secret detection analysis &amp; security assessment.

 <p>This method processes the raw secret detection data and provides clean, analyzable content
 for AI systems. It handles both compressed and uncompressed content and secrets, automatically
 decompressing GZIP content when necessary, and formats secret findings for optimal
 AI analysis and risk assessment.</p>

 <h4 id="content-processing-strategy--heading">Content Processing Strategy:</h4>
 <p>The method employs a multi-stage approach for content extraction:</p>
 <ol>
   <li><strong>Error Prioritization:</strong> If error field is present, includes error details</li>
   <li><strong>Data Validation:</strong> Checks for presence of secret detection data</li>
   <li><strong>Source Information:</strong> Extracts source file or location details</li>
   <li><strong>Message Processing:</strong> Includes descriptive scan messages</li>
   <li><strong>Content Decompression:</strong> Handles compressed scan content</li>
   <li><strong>Secret Extraction:</strong> Processes and formats detected secrets</li>
 </ol>

 <h4 id="error-content-format--heading">Error Content Format:</h4>
 <p>When secret detection errors are present, the content includes diagnostic information:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-text">Error: Repository access denied: Insufficient permissions for secret scanning
Source: protected_repository
Message: Access denied to private repository
</code></pre>
</div>


 <h4 id="successful-detection-content-format--heading">Successful Detection Content Format:</h4>
 <p>For successful secret detection, provides comprehensive security analysis data:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-text">Source: src/main/resources/application.properties
Message: Configuration file secret scan completed
Content: database.password=mySecretPassword123
api.key=sk-1234567890abcdef
aws.access.key=AKIAIOSFODNN7EXAMPLE
Secrets:
- Type: database_password, Values: [mySecretPassword123]
- Type: api_key, Values: [sk-1234567890abcdef]
- Type: aws_access_key, Values: [AKIAIOSFODNN7EXAMPLE]
</code></pre>
</div>


 <h4 id="ai-analysis-applications--heading">AI Analysis Applications:</h4>
 <ul>
   <li><strong>Risk Assessment:</strong> AI-driven evaluation of secret exposure severity</li>
   <li><strong>False Positive Reduction:</strong> ML-based filtering of test/dummy credentials</li>
   <li><strong>Pattern Learning:</strong> Adaptive pattern recognition for new secret types</li>
   <li><strong>Compliance Monitoring:</strong> Automated compliance checking &amp; reporting</li>
   <li><strong>Remediation Guidance:</strong> AI-generated recommendations for secret management</li>
 </ul>

 <h4 id="performance-considerations--heading">Performance Considerations:</h4>
 <ul>
   <li><strong>Compression Detection:</strong> Automatic detection of compressed content &amp; secrets</li>
   <li><strong>Lazy Decompression:</strong> Decompresses only when content is requested</li>
   <li><strong>Error Resilience:</strong> Graceful handling of corrupted or malformed data</li>
   <li><strong>Memory Efficiency:</strong> Optimized processing of large secret datasets</li>
 </ul></div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Log.html#getContentToAnalyze()">getContentToAnalyze</a></code>&nbsp;in interface&nbsp;<code><a href="Log.html" title="interface in com.diploma.inno.dto">Log</a></code></dd>
<dt>Specified by:</dt>
<dd><code><a href="TypedLog.html#getContentToAnalyze()">getContentToAnalyze</a></code>&nbsp;in class&nbsp;<code><a href="TypedLog.html" title="class in com.diploma.inno.dto">TypedLog</a></code></dd>
<dt>Returns:</dt>
<dd>formatted string containing secret detection information optimized for AI analysis.
         Returns error information when present, followed by source context, scan content,
         and detailed secret findings, or "No content available" if no data is present.</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a></code> - if decompression fails, secret data is corrupted, or processing errors occur</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="TypedLog.html#getContentToAnalyze()"><code>TypedLog.getContentToAnalyze()</code></a></li>
<li><code>decodeGzipMessage(String)</code></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getConversationId()">
<h3>getConversationId</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getConversationId</span>()</div>
<div class="block">Provides the conversation identifier for chat memory correlation.

 <p>Returns the Jenkins job name as the conversation identifier, enabling
 proper correlation of secret detection results with specific Jenkins jobs in the
 AI analysis pipeline. This ensures that secret detection results are grouped with
 related build logs and analysis results.</p>

 <h4 id="conversation-grouping-strategy--heading">Conversation Grouping Strategy:</h4>
 <p>Using job name as conversation ID enables:</p>
 <ul>
   <li><strong>Security Correlation:</strong> Links secret detection results to specific Jenkins jobs</li>
   <li><strong>Historical Analysis:</strong> Tracks secret exposure trends &amp; remediation over time</li>
   <li><strong>Context Preservation:</strong> Maintains conversation continuity for AI analysis</li>
   <li><strong>Memory Management:</strong> Enables efficient conversation-based cleanup</li>
 </ul>

 <h4 id="integration-with-chat-memory--heading">Integration with Chat Memory:</h4>
 <p>The conversation ID is used by <a href="../component/SimpleDbChatMemory.html" title="class in com.diploma.inno.component"><code>SimpleDbChatMemory</code></a> for:</p>
 <ul>
   <li>Message storage and retrieval</li>
   <li>Conversation history management</li>
   <li>AI context preparation</li>
   <li>Secret detection sequence tracking</li>
 </ul></div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="Log.html#getConversationId()">getConversationId</a></code>&nbsp;in interface&nbsp;<code><a href="Log.html" title="interface in com.diploma.inno.dto">Log</a></code></dd>
<dt>Specified by:</dt>
<dd><code><a href="TypedLog.html#getConversationId()">getConversationId</a></code>&nbsp;in class&nbsp;<code><a href="TypedLog.html" title="class in com.diploma.inno.dto">TypedLog</a></code></dd>
<dt>Returns:</dt>
<dd>the Jenkins job name serving as the conversation identifier,
         or <code>null</code> if no job name is set</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="TypedLog.html#getConversationId()"><code>TypedLog.getConversationId()</code></a></li>
<li><a href="../component/SimpleDbChatMemory.html#add(java.lang.String,java.util.List)"><code>SimpleDbChatMemory.add(String, java.util.List)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<div class="block">Returns a string representation of this SecretDetection object.

 <p>Provides a human-readable representation of the secret detection result including
 job context, detection data, build number, and error information for debugging
 and logging purposes.</p></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></code></dd>
<dt>Returns:</dt>
<dd>string representation of the SecretDetection object</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toJson()">
<h3>toJson</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toJson</span>()</div>
<div class="block">Converts the secret detection result to JSON format for data exchange &amp; storage.

 <p>This method provides robust JSON serialization of the complete secret detection information
 including source context, scan content, detected secrets, compression metadata, error information,
 and other relevant data. It uses Jackson's ObjectMapper for comprehensive serialization with
 proper error handling.</p>

 <h4 id="serialization-features--heading">Serialization Features:</h4>
 <ul>
   <li><strong>Complete Data:</strong> Serializes all secret detection data &amp; metadata</li>
   <li><strong>Null Handling:</strong> Excludes null values for cleaner JSON output</li>
   <li><strong>Error Recovery:</strong> Returns empty JSON object on serialization failure</li>
   <li><strong>Logging:</strong> Comprehensive error logging for debugging</li>
 </ul>

 <h4 id="output-format--heading">Output Format:</h4>
 <p>The JSON output includes all relevant secret detection information:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "secret_detection",
  "job_name": "security-scan-pipeline",
  "build_number": 123,
  "data": {
    "source": "src/main/resources/application.properties",
    "message": "Configuration file secret scan completed",
    "content_compressed": false,
    "content": "database.password=mySecretPassword123\napi.key=sk-1234567890abcdef",
    "secrets_compressed": false,
    "secrets": {
      "database_password": ["mySecretPassword123"],
      "api_key": ["sk-1234567890abcdef"],
      "aws_access_key": ["AKIAIOSFODNN7EXAMPLE"]
    }
  },
  "error": null,
  "timestamp": "2024-01-15T10:30:00Z"
}
</code></pre>
</div>


 <h4 id="compressed-content-output--heading">Compressed Content Output:</h4>
 <p>For compressed secret detection data, the JSON includes Base64-encoded content:</p>
 
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-json">{
  "type": "secret_detection",
  "job_name": "enterprise-secret-scan",
  "build_number": 456,
  "data": {
    "source": "entire_repository_scan",
    "message": "Full repository secret scan with 500+ files",
    "content_compressed": true,
    "content": "H4sIAAAAAAAA/62QwQrCMBBE7+UrHnuxVqsHwQMf4MmTJ...",
    "secrets_compressed": true,
    "secrets": "H4sIAAAAAAAA/3WQwQrCMBBE7+UrHnuxVqsHwQMf4MmTJ..."
  },
  "error": null
}
</code></pre>
</div>


 <h4 id="error-handling--heading">Error Handling:</h4>
 <p>The method includes comprehensive error handling:</p>
 <ul>
   <li><strong>Exception Catching:</strong> Catches all JSON processing exceptions</li>
   <li><strong>Fallback Response:</strong> Returns "{}" on serialization failure</li>
   <li><strong>Error Logging:</strong> Logs detailed error information for debugging</li>
   <li><strong>Graceful Degradation:</strong> Ensures system continues operation</li>
 </ul>

 <h4 id="usage-scenarios--heading">Usage Scenarios:</h4>
 <ul>
   <li><strong>Message Queue:</strong> Serialization for RabbitMQ transmission</li>
   <li><strong>Database Storage:</strong> JSON storage in chat memory</li>
   <li><strong>API Responses:</strong> REST API data exchange</li>
   <li><strong>Security Reporting:</strong> Structured logging of secret detection results</li>
 </ul></div>
<dl class="notes">
<dt>Returns:</dt>
<dd>JSON string representation of the secret detection result,
         or "{}" if serialization fails</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="Log.html#toJson()"><code>Log.toJson()</code></a></li>
<li><code>ObjectMapper.writeValueAsString(Object)</code></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
